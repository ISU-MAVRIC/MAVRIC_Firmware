/*
 * PCA9685.hpp
 *
 *  Created on: May 30, 2016
 *      Author: James
 */

#ifndef INCLUDE_PCA9685_HPP_
#define INCLUDE_PCA9685_HPP_

#include "msp.h"

namespace Externals {

class PCA9685 {
private:
  unsigned char _address;
  EUSCI_B_Type* _bus;
  
public:
  class Servo : Periphierals::Servo
  {
  private:
    int _index;
    unsigned short _offset;
    PCA9685& _parent;
    float Position;
    
  public:
    unsigned short LowerLimit;
    unsigned short UpperLimit;
    
    Servo(int index, PCA9685& parent);
    void Center();
    void GoTo(float percent);
  };
  Servo Port0;
  Servo Port1;
  Servo Port2;
  Servo Port3;
  Servo Port4;
  Servo Port5;
  Servo Port6;
  Servo Port7;
  Servo Port8;
  Servo Port9;
  Servo Port10;
  Servo Port11;
  Servo Port12;
  Servo Port13;
  Servo Port14;
  Servo Port15;
  
  PCA9685(EUSCI_B_Type* I2C_bus, unsigned char I2C_address);
  void SetServoCounts(int ServoIndex, unsigned short OnCounts, unsigned short OffCounts);
};

} /* namespace Devices */

#endif /* INCLUDE_PCA9685_HPP_ */
